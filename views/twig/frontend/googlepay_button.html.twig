{% hasrights { ident: "PAYWITHGOOGLEPAY" } %}
    {% set sToken = oViewConf.getSessionChallengeToken() %}
    {% set sSelfLink = oViewConf.getSslSelfLink()|replace({"&amp;": "&"}) %}
    {% set oPPconfig = oViewConf.getPayPalCheckoutConfig() %}
    {% set oConfig = oViewConf.getConfig() %}
    {% set buttonId = oView.getPayment().getId() %}
    {% set bGooglePayDelivery = oConfig.getConfigParam('oscPayPalUseGooglePayAddress') %}
    <style>
        #oscpaypal_googlepay {
            float: right;
        }
    </style>
    <div id="{{paymentId}}"
         class="paypal-button-container paypal-button-wrapper large"
         data-button-id="{{ buttonId }}"
         data-token="{{ sToken }}"
         data-self-link="{{ sSelfLink }}"
         data-use-google-pay-address="{{ bGooglePayDelivery }}"
         data-is-sandbox="{{ oPPconfig.isSandbox() }}"
         data-merchant-name="{{ oxcmp_shop.oxshops__oxname.value|json_encode }}"
         data-total-price="{{ oxcmp_basket.getPrice().getBruttoPrice() }}"
         data-currency="{{ oView.getActCurrency().name }}"
         data-delivery-address-md5="{{ oView.getDeliveryAddressMD5() }}"
    ></div>
    <script>
        window.googlePayReady = new Promise(resolve => {
            window.onGooglePayLoaded = resolve;
        });
    </script>
    <script async src="https://pay.google.com/gp/p/js/pay.js" onload="window.onGooglePayLoaded()"></script>
{% endhasrights %}